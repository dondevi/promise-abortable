var AbortablePromise=function(){"use strict";function u(o,r){this.promise=new Promise(function(n,t){r=r||function(){var t=function(){var t={aborted:!1,onabort:null};return t.dispatchEvent=function(n){"function"==typeof t.onabort&&t.onabort(n)},t}();return{signal:t,abort:function(n){t.aborted||(t.aborted=!0,t.dispatchEvent(n))}}}(),o(n,t,r.signal)}),this.abortController=r}function e(n,t){t.onabort=function(t){n.forEach(function(n){n instanceof u&&n.abort(t).catch(function(n){return n})})}}return((u.prototype=new Promise(function(){})).constructor=u).prototype.then=function(o,r){var n=this;return new u(function(e,i,c){function t(n,t,o){if("function"==typeof o){if((t=o(t))instanceof u){var r=t.abortController.signal;c.aborted=r.aborted,c.onabort=r.onabort}return e(t)}"resolved"===n&&e(t),"rejected"===n&&i(t)}n.promise.then(function(n){t("resolved",n,o)},function(n){t("rejected",n,r)})},this.abortController)},u.prototype.catch=function(n){return this.then(null,n)},u.prototype.abort=function(o){var r=this;return new u(function(n,t){Promise.resolve().then(function(){r.abortController.abort(o),r.then(n,t)})},this.abortController)},u.resolve=function(o){return new u(function(n,t){n(o)})},u.reject=function(o){return new u(function(n,t){t(o)})},u.all=function(r){return new u(function(n,t,o){e(r,o),Promise.all(r).then(n,t)})},u.race=function(r){return new u(function(n,t,o){e(r,o),Promise.race(r).then(n,t)})},u}();
